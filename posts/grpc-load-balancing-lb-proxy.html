<html>

<head>
  <title>gRPC Load balancing (3) - LB as Proxy | Linh tinh</title>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html;">
  <meta name=viewport content="initial-scale=1.0 maximum-scale=1.0">
  <meta property='og:image' content='https://melancholy.com/img/default.jpg'>
  <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
  <link rel="manifest" href="../manifest.json">
  <link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
  <meta name="theme-color" content="#ffffff">
  <link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin-ext,vietnamese"
    rel="stylesheet">
  <!-- <link href="../css/theme.css?t=" rel="stylesheet" type="text/css"> -->
  <link href="/css/theme.css" rel="stylesheet" type="text/css">
  <!-- <link href="/css/gruvbox-dark.css" rel="stylesheet" type="text/css"> -->
  <link rel="stylesheet" href="../css/highlight/tomorrow.css">
  <link rel="stylesheet" href="../css/fontello.css">
  <link rel="stylesheet" href="../emoji/css/emoji.dist.css">
  <link rel="stylesheet" href="../emoji/css/emojione.min.css">
  <link rel="stylesheet" href="../emoji/css/messenger.min.css">
  <link rel="stylesheet" href="../emoji/css/thinking.ext.css">
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css"> -->
  <script src="../js/highlight.min.js"></script>
  <script src="../js/autosizing.js"></script>
  <script src="../js/fetch.js"></script>
  <script src="../js/toc.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
    hljs.highlightAll();
  </script>
</head>

<body>
  <div class="header">
    <a href="/"><span class="avatar"></span><span class="header-link">Linh tinh</span></a>
  </div>
  <div class="container has-toc navigation-box">
            <p><a href="/">&larr; Quay v·ªÅ trang ch·ªß</a></p>
        </div>
  <div class="container has-toc">
    <div class="table-of-contents">
        <div class="toc-title">M·ª•c l·ª•c</div>
        <ul class="toc-list">  <li><a href="#load-balancer-reverse-proxy" class="toc-link toc-level-2"><span class="toc-hash">#</span> Load balancer / Reverse proxy</a></li>
  <li><a href="#hien-thuc-va-kiem-tra" class="toc-link toc-level-2"><span class="toc-hash">#</span> Hi·ªán th·ª±c v√† ki·ªÉm tra</a></li>
    <li><a href="#layer-4" class="toc-link toc-level-3"><span class="toc-hash">#</span> Layer 4</a></li>
    <li><a href="#layer-7" class="toc-link toc-level-3"><span class="toc-hash">#</span> Layer 7</a></li>
  <li><a href="#tong-ket" class="toc-link toc-level-2"><span class="toc-hash">#</span> T·ªïng k·∫øt</a></li>
  <li><a href="#ma-nguon" class="toc-link toc-level-2"><span class="toc-hash">#</span> M√£ ngu·ªìn</a></li>
  <li><a href="#tham-khao" class="toc-link toc-level-2"><span class="toc-hash">#</span> Tham kh·∫£o</a></li></ul>
    </div>
    <div class="main">
      <h1>gRPC Load balancing (3) - LB as Proxy</h1>
      <p><a href="https://notes-ngtam.pages.dev/posts/grpc-load-balancer">·ªû b√†i vi·∫øt ƒë·∫ßu ti√™n v·ªÅ c√¢n b·∫±ng t·∫£i gRPC</a>, m√¨nh ƒë√£ t√¨m hi·ªÉu v·ªÅ c√°c √Ω t∆∞·ªüng c√¢n b·∫±ng t·∫£i cho <code>gRPC</code> protocol, d·ª±a tr√™n ph·∫ßn l√Ω thuy·∫øt ƒë√≥, h√¥m nay m√¨nh s·∫Ω l√†m m·ªôt v√≠ d·ª• s·ª≠ d·ª•ng <code>load balancer</code>. ·ªû m√¥ h√¨nh n√†y, <code>load balancer</code> ƒë√≥ng vai tr√≤ nh∆∞ m·ªôt <code>reverse proxy</code> cho c·ª•m backend server.</p>
<h2 id="load-balancer-reverse-proxy">Load balancer / Reverse proxy</h2>
<p>Ch√∫ng ta c·∫ßn m·ªôt load balancer ƒë·ª©ng gi·ªØa client v√† server, c√≥ nhi·ªÅu ·ª©ng vi√™n c√≥ th·ªÉ l√†m ƒë∆∞·ª£c vi·ªác n√†y m·ªôt c√°ch hi·ªáu qu·∫£, v√≠ d·ª•:</p>
<ul>
<li>HAProxy</li>
<li>Nginx</li>
<li>LB c·ªßa c√°c cloud provider</li>
</ul>
<p><strong>∆Øu ƒëi·ªÉm</strong></p>
<ul>
<li>D·ªÖ c√†i ƒë·∫∑t v√† s·ª≠ d·ª•ng.</li>
<li>Kh√¥ng ph·ª• thu·ªôc v√†o ng√¥n ng·ªØ l·∫≠p tr√¨nh khi hi·ªán th·ª±c client/server.</li>
<li>TƒÉng t√≠nh an to√†n cho server.</li>
<li>C√≥ th·ªÉ scale b·∫±ng c√°ch th√™m nhi·ªÅu instance c·ªßa load balancer.</li>
</ul>
<p><strong>Nh∆∞·ª£c ƒëi·ªÉm</strong></p>
<ul>
<li>N·∫øu kh√¥ng qu·∫£n l√Ω t·ªët, load balancer c√≥ th·ªÉ l√† ƒëi·ªÉm g√¢y l·ªói duy nh·∫•t (single point of failure).</li>
<li>TƒÉng latency c·ªßa request.</li>
</ul>
<h2 id="hien-thuc-va-kiem-tra">Hi·ªán th·ª±c v√† ki·ªÉm tra</h2>
<p>V√≠ d·ª• n√†y c·ªßa m√¨nh s·ª≠ d·ª•ng <code>HAProxy</code> l√†m load balancer v√† server/client ƒë∆∞·ª£c hi·ªán th·ª±c b·∫±ng <code>Go</code>.</p>
<p><em><strong>gRPC proto</strong></em></p>
<pre><code>syntax = &quot;proto3&quot;;

package dnt;

option go_package = &quot;/model&quot;;

service DemoService {
  rpc SayHello (HelloRequest) returns (HelloResponse);
  rpc SayHelloStream(stream HelloRequest) returns (stream HelloResponse);
}

message HelloRequest {
  string name = 1;
}

message HelloResponse {
  string serverId = 1;
}
</code></pre>
<h3 id="layer-4">Layer 4</h3>
<p>Khi c√¢n b·∫±ng t·∫£i ·ªü L4, ch√∫ng ta s·∫Ω n√≥i ƒë·∫øn <code>connection-based loadbalancing</code>, m√¥ h√¨nh nh∆∞ sau:</p>
<p><img src="img/grpc-loadbalacning-lb-proxy.png" alt="lb-proxy" /></p>
<p>Vi·ªác c√¢n b·∫±ng t·∫£i ƒë∆∞·ª£c th·ª±c hi·ªán <strong>·ªü giai ƒëo·∫°n thi·∫øt l·∫≠p connection</strong>, sau ƒë√≥, LB s·∫Ω nh∆∞ m·ªôt proxy ƒë·ªÉ chuy·ªÉn ti·∫øp c√°c requests t·ª´ c√°c connection ƒë·∫øn server t∆∞∆°ng ·ª©ng.</p>
<p><em><strong>HAProxy</strong></em></p>
<p>C·∫•u h√¨nh file <code>haproxy.cfg</code> c√≥ m·ªôt v√†i ƒëi·ªÉm c·∫ßn ch√∫ √Ω nh∆∞ sau:</p>
<ul>
<li><code>frontend lb_grpc</code>: ch·ªâ d·∫´n <code>HAProxy</code> l·∫Øng nghe k·∫øt n·ªëi ·ªü port <code>8443</code>.</li>
<li><code>backend be_grpc</code>: khai b√°o c√°c backend servers.</li>
<li><code>mode tcp</code> c·∫•u h√¨nh HAProxy ho·∫°t ƒë·ªông ·ªü L4 (TCP)</li>
<li><code>balance roundrobin</code>: s·ª≠ d·ª•ng thu·∫≠t to√°n <code>roundrobin</code> ƒë·ªÉ c√¢n b·∫±ng t·∫£i connection.</li>
</ul>
<pre><code># HAProxy version: 3.1.0-f2b9791
global
  tune.ssl.default-dh-param 1024

defaults
  timeout connect 10000ms
  timeout client 60000ms
  timeout server 60000ms

frontend lb_grpc
  mode tcp
  bind *:8443 proto h2
  default_backend be_grpc

# gRPC servers running on port 50051-50052-50053
backend be_grpc
  mode tcp
  balance roundrobin
  option httpchk HEAD / HTTP/2
  server srv01 127.0.0.1:50051
  server srv02 127.0.0.1:50052
  server srv03 127.0.0.1:50053
</code></pre>
<p>Ch·∫°y HAProxy ·ªü m√¥i tr∆∞·ªùng local b·∫±ng l·ªánh <code>haproxy -f /opt/homebrew/etc/haproxy.cfg</code>, k·∫øt qu·∫£ c·ªßa l·ªánh <code>netstat</code> cho th·∫•y <code>HAProxy</code> ƒëang l·∫Øng nghe ·ªü port <code>8443</code>.</p>
<p><img src="img/haproxy-listen.png" alt="haproxy-listen" /></p>
<p><em><strong>Server</strong></em></p>
<p>M√¨nh s·∫Ω ch·∫°y 3 <code>gRPC server</code> l·∫Øng nghe tr√™n 3 port, c√≥ method s·∫Ω tr·∫£ v·ªÅ <code>server ID</code> m·ªói khi nh·∫≠n request t·ª´ ph√≠a client, m·ª•c ƒë√≠ch th·ªëng k√™ cho k·∫øt qu·∫£ test.</p>
<pre><code class="language-go">func main() {
	go serve(&quot;50051&quot;)
	go serve(&quot;50052&quot;)
	go serve(&quot;50053&quot;)
	ctx, stop := signal.NotifyContext(context.Background(), syscall.SIGINT, syscall.SIGTERM)
	defer stop()
	&lt;-ctx.Done()
}

func serve(port string) {
	lis, err := net.Listen(&quot;tcp&quot;, &quot;:&quot;+port)
	if err != nil {
		log.Fatalf(&quot;failed to listen: %v&quot;, err)
	}
	s := grpc.NewServer()
	pb.RegisterDemoServiceServer(s, &amp;server{serverId: port})

	fmt.Println(&quot;server is running on port &quot; + port)
	if err := s.Serve(lis); err != nil {
		log.Fatalf(&quot;failed to serve: %v&quot;, err)
	}
}
</code></pre>
<p><em><strong>Client</strong></em></p>
<p>ƒê·ªÉ ki·ªÉm tra c√¢n b·∫±ng t·∫£i L4, m√¨nh s·ª≠ d·ª•ng <code>unuary method</code> c·ªßa gRPC, √Ω t∆∞·ªüng ƒë·ªÉ x√¢y d·ª±ng ch∆∞∆°ng tr√¨nh ki·ªÉm tra:</p>
<ul>
<li>T·∫°o 3 clients <code>gRPC</code>, gRPC m·∫∑c ƒë·ªãnh s·ª≠ d·ª•ng <code>passthrough resolver</code> n√™n 3 clients t∆∞∆°ng ·ª©ng v·ªõi 3 connections.</li>
<li>B·∫Øt ƒë·∫ßu g·ª≠i requests tr√™n m·ªói client m·ªói <code>20ms</code>.</li>
</ul>
<p>Theo nh∆∞ nh·ªØng ph√¢n t√≠ch ·ªü tr∆∞·ªõc, L4 th·ª±c hi·ªán c√¢n b·∫±ng t·∫£i l√∫c thi·∫øt l·∫≠p connection, do ƒë√≥ k·∫øt qu·∫£ ki·ªÉm tra n√†y ph·∫£i ch·ª©ng minh ƒë∆∞·ª£c t·∫•t c·∫£ requests ƒë∆∞·ª£c g·ª≠i tr√™n m·ªói connection s·∫Ω ch·ªâ ƒë∆∞·ª£c x·ª≠ l√Ω b·ªüi 1 server duy nh·∫•t, m√¨nh s·ª≠ d·ª•ng th√¥ng tin <code>server ID</code> cho m·ª•c ƒë√≠ch n√†y.</p>
<pre><code class="language-go">func unaryTest(index int, requests *int, c pb.DemoServiceClient, responses map[string]bool, responseLock *sync.Mutex, stopCh chan struct{}) {
	ticker := time.NewTicker(requestInterval)
	defer ticker.Stop()

stop:
	for {
		select {
		case &lt;-stopCh:
			break stop
		case &lt;-ticker.C:
			go doSendUnaryRequest(index, requests, c, responses, responseLock)
		}
	}
	fmt.Printf(&quot;client %v make %v requests, received all response from %v server(s), detail: %+v\n&quot;, index, requests, len(responses), responses)
}
</code></pre>
<p><em><strong>K·∫øt qu·∫£</strong></em></p>
<p>S·ª≠ d·ª•ng <code>netstat</code> ƒë·ªÉ ki·ªÉm tra s·ªë l∆∞·ª£ng connection t·ª´ client t·ªõi HAProxy v√† t·ª´ HAProxy t·ªõi server.</p>
<p><img src="img/haproxy-connections-L4.png" alt="haproxy-connections-L4" /></p>
<p>Ch·∫°y ch∆∞∆°ng tr√¨nh m·ªôt th·ªùi gian, d·ª±a v√†o k·∫øt qu·∫£ ·ªü h√¨nh d∆∞·ªõi, m√¨nh th·∫•y <strong>t·∫•t c·∫£ requests tr√™n m·ªôt client ƒë∆∞·ª£c s·ª≠ l√Ω b·ªüi duy nh·∫•t m·ªôt server</strong>, ƒëi·ªÅu n√†y ƒë√∫ng v·ªõi nh·ªØng ƒëi·ªÅu m√¨nh ƒë√£ ph√¢n t√≠ch.</p>
<p><img src="img/haproxy-test-result-L4.png" alt="haproxy-test-result-L4" /></p>
<h3 id="layer-7">Layer 7</h3>
<p><em><strong>HAProxy</strong></em></p>
<p>L·∫ßn n√†y, <code>HAProxy</code> s·∫Ω s·ª≠ d·ª•ng <code>mode http</code> ƒë·ªÉ ho·∫°t ƒë·ªông ·ªü <code>L7</code>.</p>
<pre><code># HAProxy version: 3.1.0-f2b9791
global
  tune.ssl.default-dh-param 1024

defaults
  timeout connect 10000ms
  timeout client 60000ms
  timeout server 60000ms

frontend lb_grpc
  mode http
  bind *:8443 proto h2
  default_backend be_grpc

# gRPC servers running on port 50051-50052-50053
backend be_grpc
  mode http
  balance roundrobin

  server srv01 127.0.0.1:50051 check proto h2
  server srv02 127.0.0.1:50052 check proto h2
  server srv03 127.0.0.1:50053 check proto h2
</code></pre>
<p>M√¥ h√¨nh ho·∫°t ƒë·ªông nh∆∞ h√¨nh sau:</p>
<p><img src="img/grpc-loadbalacning-L7.png" alt="grpc-loadbalacning-L7" /></p>
<p><em><strong>Client</strong></em></p>
<p>·ªû ph√≠a client, b√™n c·∫°nh <code>unary method</code>, l·∫ßn n√†y m√¨nh s·∫Ω s·ª≠ d·ª•ng th√™m <code>stream method</code> ƒë·ªÉ ki·ªÉm tra.</p>
<p><strong>Unary method</strong></p>
<p>L·∫ßn n√†y vi·ªác c√¢n b·∫±ng t·∫£i ·ªü HAProxy s·∫Ω d·ª±a v√†o request, n√™n m√¨nh k√¨ v·ªçng requests ·ªü m·ªói client s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω b·ªüi c·∫£ 3 servers.</p>
<p><em><strong>K·∫øt qu·∫£</strong></em></p>
<p>ƒê√∫ng nh∆∞ k√¨ v·ªçng, requests t·ª´ m·ªói client ƒë∆∞·ª£c <code>HAProxy</code> g·ª≠i t·ªõi c·∫£ 3 servers.</p>
<p><img src="img/haproxy-test-result-L7-unary.png" alt="haproxy-test-result-L7-unary" /></p>
<p><strong>Bidirectaional stream method</strong></p>
<p>ƒê·ªëi v·ªõi <code>bidirectaional stream method</code> c·ªßa gRPC, m·ªôt khi method ƒë∆∞·ª£c g·ªçi, client v√† server c√≥ th·ªÉ g·ª≠i message cho nhau li√™n t·ª•c, v·∫≠y nh·ªØng message n√†y ph·∫£i ƒë∆∞·ª£c x·ª≠ l√Ω b·ªüi c√πng 1 backend server ƒë·ªÉ method c√≥ th·ªÉ ho·∫°t ƒë√∫ng ch·ª©c nƒÉng. H√£y ki·ªÉm tra v·ªõi HAProxy v·ªÅ vi·ªác c√¢n b·∫±ng t·∫£i n√†y v·ªõi thi·∫øt l·∫≠p nh∆∞ sau:</p>
<ul>
<li>G·ªçi <code>bidirectaional stream method</code> tr√™n m·ªói client.</li>
<li>Tr√™n m·ªói stream, client g·ª≠i <code>5000 messages</code> ƒë·∫øn server.</li>
</ul>
<pre><code class="language-go">func streamTest(index int, requests *int, client pb.DemoServiceClient, responses map[string]bool, responseLock *sync.Mutex) {
	*requests = *requests + 1
	stream, err := client.SayHelloStream(context.Background())
	if err != nil {
		log.Fatalf(&quot;could not call SayHello: %v&quot;, err)
	}

	for i := 0; i &lt; requestOnStream; i++ {
		req := &amp;pb.HelloRequest{
			Name: fmt.Sprintf(&quot;client %d&quot;, i),
		}
		if err := stream.Send(req); err != nil {
			log.Fatalf(&quot;failed to send request: %v&quot;, err)
		}
		response, err := stream.Recv()
		if err != nil {
			log.Fatalf(&quot;failed to receive response: %v&quot;, err)
		}
		responseLock.Lock()
		responses[response.ServerId] = true
		responseLock.Unlock()
	}
	if err := stream.CloseSend(); err != nil {
		log.Fatalf(&quot;failed to close stream: %v&quot;, err)
	}
	fmt.Printf(&quot;client %v make %v requests, received all response from %v server(s), detail: %+v\n&quot;, index, *requests, len(responses), responses)
}
</code></pre>
<p><em><strong>K·∫øt qu·∫£</strong></em></p>
<p>T·∫•t c·∫£ messages tr√™n m·ªói stream ƒë∆∞·ª£c x·ª≠ l√Ω b·ªüi 1 server v√† ta c≈©ng c√≥ th·ªÉ th·∫•y, HAProxy c√¢n b·∫±ng t·∫£i 3 stream ƒë·∫øn 3 servers.</p>
<p><img src="img/haproxy-test-result-L7-stream.png" alt="haproxy-test-result-L7-stream" /></p>
<p><em><strong>Nh·∫≠n x√©t</strong></em></p>
<p>V·ªÅ m·∫∑t g·ª≠i nh·∫≠n message, <code>bidirectional stream</code> c·ªßa gRPC c≈©ng t·ª±a t·ª±a <code>web socket</code>, protocol c√≥ t√≠nh <a href="https://docs.aws.amazon.com/prescriptive-guidance/latest/load-balancer-stickiness/options.html">stickiness</a>, do ƒë√≥ b·∫°n s·∫Ω th·∫•y, khi m√¨nh c·∫•u h√¨nh <code>HAProxy</code> ·ªü L7, m√¨nh kh√¥ng c·∫ßn ph·∫£i quan t√¢m ƒë·∫øn t√≠nh nƒÉng <code>stick table</code>. V·ªÅ c∆° b·∫£n, <code>HAProxy</code> ƒë√£ hi·ªán th·ª±c nh·ªØng t√≠nh ch·∫•t n√†y khi c√¢n b·∫±ng t·∫£i <code>gRPC</code>, m√† th·ª±c ch·∫•t l√† <code>HTTP/2</code>.</p>
<h2 id="tong-ket">T·ªïng k·∫øt</h2>
<p>·ªû b√†i vi·∫øt n√†y, m√¨nh ƒë√£ ph√¢n t√≠ch s√¢u h∆°n c√°ch load balancer c√¢n b·∫±ng t·∫£i gRPC protol v·ªõi nh·ªØng ch∆∞∆°ng tr√¨nh ki·ªÉm tra tr√™n <code>HAProxy</code>, qua ƒë√≥ hi·ªÉu th√™m v·ªÅ c√°ch connection, requests ƒë∆∞·ª£c x·ª≠ l√Ω.</p>
<ul>
<li>LB ho·∫°t ƒë·ªông ·ªü L4 s·∫Ω th·ª±c hi·ªán c√¢n b·∫±ng t·∫£i ngay khi connection ƒë∆∞·ª£c thi·∫øt l·∫≠p.</li>
<li>LB h·∫°ot ƒë·ªông ·ªü L7 s·∫Ω th·ª±c hi·ªán c√¢n b·∫±ng t·∫£i requests.</li>
<li>ƒê·∫∑c t√≠nh <code>stickiness</code> t·ª± nhi√™n c·ªßa <code>stream method</code> gi·ªëng v·ªõi <code>web socket</code>, v√¨ v·∫≠y n·∫øu ch·ªâ ƒë·ªÉ c√¢n b·∫±ng t·∫£i, ch√∫ng ta kh√¥ng c·∫ßn s·ª≠ d·ª•ng t√≠nh nƒÉng n√†y tr√™n c√°c LB.</li>
</ul>
<h2 id="ma-nguon">M√£ ngu·ªìn</h2>
<p>B·∫°n c√≥ th·ªÉ tham kh·∫£o m√£ ngu·ªìn ·ªü repository <a href="https://github.com/dntam00/grpc-loadblancing">grpc-loadblancing</a>.</p>
<h2 id="tham-khao">Tham kh·∫£o</h2>
<ul>
<li><a href="https://grpc.io/blog/grpc-load-balancing/">gRPC Load Balancing</a></li>
<li><a href="https://www.haproxy.com/documentation/haproxy-configuration-tutorials/load-balancing/grpc/">gRPC - HaProxy</a></li>
<li><a href="https://andreaskaris.github.io/blog/networking/haproxy-and-h2c/">haproxy and HTTP/2</a></li>
</ul>

      <div class='other-tags'><b>Tags:</b> <a class='topic-tag' href='/tags/networking.html'>networking</a><a class='topic-tag' href='/tags/gRPC.html'>gRPC</a></div>
      <!-- <div class="copyright">
                B·∫°n ƒë∆∞·ª£c to√†n quy·ªÅn chia s·∫ª, tr√≠ch d·∫´n ho·∫∑c copy, post l·∫°i, nh∆∞ng vui l√≤ng ghi r√µ ngu·ªìn, t√°c gi·∫£ v√† kh√¥ng l√†m thay ƒë·ªïi n·ªôi dung b√†i vi·∫øt. N·∫øu kh√¥ng l√†m v·∫≠y, th√¨ OK, c≈©ng ko sao, s·∫Ω c√≥ thi√™n l√¥i thay ta d√≤m ng√≥ nh√† ng∆∞∆°i. üòà
                </div> -->
    </div>
  </div>
  <div class="footer">
    <p>Created with <i class="em em-coffee"></i> <a href="http://github.com/huytd/ristretto-rs">ristretto.rs</a></p>
    <div class="social">
      <a target="_blank" href="https://github.com/dntam00"><i class="icon-github-squared"></i></a>
      <a target="_blank" href="https://www.linkedin.com/in/dang-ngoc-tam/"><i class="icon-linkedin-squared"></i></a>
    </div>
  </div>
  <script type="text/javascript" async=""
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            skipTags: ["script","noscript","style","textarea", "code"],
            ignoreClass: ["comment", "comment-list"]
          }
        });
  </script>
</body>

</html>